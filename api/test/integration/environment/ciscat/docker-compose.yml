version: '3.7'

services:
        wazuh-master:
                build:
                        context: ./wazuh-manager
                image: wazuh-manager:3.10
                ports:
                        - "2222:22"
                        - "8080:8080"
                        - "55000:55000"
                entrypoint:
                        - /scripts/entrypoint.sh
                        - wazuh-master
                        - master-node
                        - master

        wazuh-worker1:
                build:
                        context: ./wazuh-manager
                image: wazuh-manager:3.10
                depends_on:
                        - wazuh-master
                entrypoint:
                        - /scripts/entrypoint.sh
                        - wazuh-master
                        - worker1
                        - worker
        wazuh-worker2:
                build:
                        context: ./wazuh-manager
                image: wazuh-manager:3.10
                depends_on:
                        - wazuh-master
                entrypoint:
                        - /scripts/entrypoint.sh
                        - wazuh-master
                        - worker2
                        - worker

        wazuh-agent-ciscat:
                build:
                        context: ./wazuh-agent-ciscat
                image: wazuh-agent-ciscat:3.9.2
                entrypoint:
                        - /scripts/entrypoint.sh
                        - nginx-lb
                depends_on:
                        - wazuh-master
                        - nginx-lb

        nginx-lb:
                build:
                       context: ./nginx-lb
                image: nginx-lb
                entrypoint:
                        - /scripts/entrypoint.sh
