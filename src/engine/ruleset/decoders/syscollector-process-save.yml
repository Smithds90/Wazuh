name: decoder/syscollector-process-save/0

parents:
  - decoder/syscollector-process/0

check:
  - _json.process: +ef_exists

normalize:
  - check:
      - _json.timestamp: +ef_not_exists
    map:
      - _json.timestamp: "NULL"

  - check:
      - _json.process.pid: +ef_not_exists
    map:
      - _json.process.pid: "NULL"

  - check:
      - _json.process.name: +ef_not_exists
    map:
      - _json.process.name: "NULL"

  - check:
    - _json.process.state: +ef_not_exists
    map:
      - _json.process.state: "NULL"

  - check:
      - _json.process.ppid: +ef_not_exists
    map:
      - _json.process.ppid: "NULL"

  - check:
      - _json.process.utime: +ef_not_exists
    map:
      - _json.process.utime: "NULL"

  - check:
      - _json.process.stime: +ef_not_exists
    map:
      - _json.process.stime: "NULL"

  - check:
      - _json.process.cmd: +ef_not_exists
    map:
      - _json.process.cmd: "NULL"

  - check:
      - _json.process.argvs: +ef_exists
    map:
      - _argvs_csv_str: +s_from_array/$_json.process.argvs/,

  - check:
      - _json.process.argvs: +ef_not_exists
    map:
      - _argvs_csv_str: "NULL"

  - check:
      - _json.process.euser: +ef_not_exists
    map:
      - _json.process.euser: "NULL"

  - check:
      - _json.process.ruser: +ef_not_exists
    map:
      - _json.process.ruser: "NULL"

  - check:
      - _json.process.suser: +ef_not_exists
    map:
      - _json.process.suser: "NULL"

  - check:
      - _json.process.egroup: +ef_not_exists
    map:
      - _json.process.egroup: "NULL"

  - check:
      - _json.process.rgroup: +ef_not_exists
    map:
      - _json.process.rgroup: "NULL"

  - check:
      - _json.process.sgroup: +ef_not_exists
    map:
      - _json.process.sgroup: "NULL"

  - check:
      - _json.process.fgroup: +ef_not_exists
    map:
      - _json.process.fgroup: "NULL"

  - check:
      - _json.process.priority: +ef_not_exists
    map:
      - _json.process.priority: "NULL"

  - check:
      - _json.process.nice: +ef_not_exists
    map:
      - _json.process.nice: "NULL"

  - check:
      - _json.process.size: +ef_not_exists
    map:
      - _json.process.size: "NULL"

  - check:
      - _json.process.vm_size: +ef_not_exists
    map:
      - _json.process.vm_size: "NULL"

  - check:
      - _json.process.resident: +ef_not_exists
    map:
      - _json.process.resident: "NULL"

  - check:
      - _json.process.share: +ef_not_exists
    map:
      - _json.process.share: "NULL"

  - check:
      - _json.process.start_time: +ef_not_exists
    map:
      - _json.process.start_time: "NULL"

  - check:
      - _json.process.pgrp: +ef_not_exists
    map:
      - _json.process.pgrp: "NULL"

  - check:
      - _json.process.session: +ef_not_exists
    map:
      - _json.process.session: "NULL"

  - check:
      - _json.process.nlwp: +ef_not_exists
    map:
      - _json.process.nlwp: "NULL"

  - check:
      - _json.process.tgid: +ef_not_exists
    map:
      - _json.process.tgid: "NULL"

  - check:
      - _json.process.tty: +ef_not_exists
    map:
      - _json.process.tty: "NULL"

  - check:
      - _json.process.processor: +ef_not_exists
    map:
      - _json.process.processor: "NULL"

  - map:
      - _query: +s_concat/agent /$agent.id/ process save /$_json.ID/|/$_json.timestamp/|/$_json.process.pid/|/$_json.process.name/|/$_json.process.state/|/$_json.process.ppid/|/$_json.process.utime/|/$_json.process.stime/|/$_json.process.cmd/|/$_argvs_csv_str/|/$_json.process.euser/|/$_json.process.ruser/|/$_json.process.suser/|/$_json.process.egroup/|/$_json.process.rgroup/|/$_json.process.sgroup/|/$_json.process.fgroup/|/$_json.process.priority/|/$_json.process.nice/|/$_json.process.size/|/$_json.process.vm_size/|/$_json.process.resident/|/$_json.process.share/|/$_json.process.start_time/|/$_json.process.pgrp/|/$_json.process.session/|/$_json.process.nlwp/|/$_json.process.tgid/|/$_json.process.tty/|/$_json.process.processor
      - _process_save_result: +wdb_update/$_query
