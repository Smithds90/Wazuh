name: decoder/syscollector-network-ip/0

sources:
  - decoder/syscollector-network/0

check:
  - ~query_response: +t_is_true

normalize:
  - check:
      - ~json.iface.IPv6: +ef_exists
      - ~json.iface.IPv6.gateway: +ef_not_exists
    map:
      - ~json.iface.IPv6.gateway: "NULL"

  - check:
      - ~json.iface.IPv6: +ef_exists
      - ~json.iface.IPv6.DHCP: +ef_not_exists
    map:
      - ~json.iface.IPv6.DHCP: "NULL"

  - check:
      - ~json.iface.IPv6: +ef_exists
      - ~json.iface.IPv6.metric: +ef_not_exists
    map:
      - ~json.iface.IPv6.metric: "NULL"

  - check:
      - ~json.iface.IPv6: +ef_exists
  - map:
      - ~queryIPv6: +s_concat/agent /$agent.id/ netproto save /$~json.ID/|/$~json.iface.name/|1|/$~json.iface.IPv6.gateway/|/$~json.iface.IPv6.DHCP/|/$~json.iface.IPv6.metric
      - ~netproto_ipv6_save_result: +wdb_update/$~queryIPv6

  - check:
      - ~netproto_ipv6_save_result: +t_is_true
    map:
      - ~result_sysc_ni_save_ipv6: +sysc_ni_save_ipv6/$agent.id/$~json.ID/$~json.iface.name/$~json.iface.IPv6

  - check:
      - ~json.iface.IPv4: +ef_exists
      - ~json.iface.IPv4.gateway: +ef_not_exists
    map:
      - ~json.iface.IPv4.gateway: "NULL"

  - check:
      - ~json.iface.IPv4: +ef_exists
      - ~json.iface.IPv4.DHCP: +ef_not_exists
    map:
      - ~json.iface.IPv4.DHCP: "NULL"

  - check:
      - ~json.iface.IPv4: +ef_exists
      - ~json.iface.IPv4.metric: +ef_not_exists
    map:
      - ~json.iface.IPv4.metric: "NULL"

  - check:
      - ~json.iface.IPv4: +ef_exists
  - map:
      - ~queryIPv4: +s_concat/agent /$agent.id/ netproto save /$~json.ID/|/$~json.iface.name/|0|/$~json.iface.IPv4.gateway/|/$~json.iface.IPv4.DHCP/|/$~json.iface.IPv4.metric
      - ~netproto_ipv4_save_result: +wdb_update/$~queryIPv4

  - check:
      - ~netproto_ipv4_save_result: +t_is_true
    map:
      - ~result_sysc_ni_save_ipv4: +sysc_ni_save_ipv4/$agent.id/$~json.ID/$~json.iface.name/$~json.iface.IPv4
