name: decoder/syscollector-network-ip/0

parents:
  - decoder/syscollector-network/0

check:
  - _query_response: +t_is_true

normalize:
  - check:
      - _json.iface.IPv6: +ef_exists
      - _json.iface.IPv6.gateway: +ef_not_exists
    map:
      - _json.iface.IPv6.gateway: "NULL"

  - check:
      - _json.iface.IPv6: +ef_exists
      - _json.iface.IPv6.DHCP: +ef_not_exists
    map:
      - _json.iface.IPv6.DHCP: "NULL"

  - check:
      - _json.iface.IPv6: +ef_exists
      - _json.iface.IPv6.metric: +ef_not_exists
    map:
      - _json.iface.IPv6.metric: "NULL"

  - check:
      - _json.iface.IPv6: +ef_exists
  - map:
      - _queryIPv6: +s_concat/agent /$agent.id/ netproto save /$_json.ID/|/$_json.iface.name/|1|/$_json.iface.IPv6.gateway/|/$_json.iface.IPv6.DHCP/|/$_json.iface.IPv6.metric
      - _netproto_ipv6_save_result: +wdb_update/$_queryIPv6

  - check:
      - _netproto_ipv6_save_result: +t_is_true
    map:
      - _result_sysc_ni_save_ipv6: +sysc_ni_save_ipv6/$agent.id/$_json.ID/$_json.iface.name/$_json.iface.IPv6

  - check:
      - _json.iface.IPv4: +ef_exists
      - _json.iface.IPv4.gateway: +ef_not_exists
    map:
      - _json.iface.IPv4.gateway: "NULL"

  - check:
      - _json.iface.IPv4: +ef_exists
      - _json.iface.IPv4.DHCP: +ef_not_exists
    map:
      - _json.iface.IPv4.DHCP: "NULL"

  - check:
      - _json.iface.IPv4: +ef_exists
      - _json.iface.IPv4.metric: +ef_not_exists
    map:
      - _json.iface.IPv4.metric: "NULL"

  - check:
      - _json.iface.IPv4: +ef_exists
  - map:
      - _queryIPv4: +s_concat/agent /$agent.id/ netproto save /$_json.ID/|/$_json.iface.name/|0|/$_json.iface.IPv4.gateway/|/$_json.iface.IPv4.DHCP/|/$_json.iface.IPv4.metric
      - _netproto_ipv4_save_result: +wdb_update/$_queryIPv4

  - check:
      - _netproto_ipv4_save_result: +t_is_true
    map:
      - _result_sysc_ni_save_ipv4: +sysc_ni_save_ipv4/$agent.id/$_json.ID/$_json.iface.name/$_json.iface.IPv4
