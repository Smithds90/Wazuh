name: decoder/syscollector-osinfo/0

parents:
  - decoder/syscollector-base/0

check:
  - _json.inventory: +ef_exists
  - _json.type: +s_eq/OS

normalize:
  - check:
      - _json.ID: +ef_not_exists
    map:
      - _json.ID: "NULL"

  - check:
      - _json.timestamp: +ef_not_exists
    map:
      - _json.timestamp: "NULL"

  - check:
      - _json.inventory.hostname: +ef_not_exists
    map:
      - _json.inventory.hostname: "NULL"

  - check:
      - _json.inventory.architecture: +ef_not_exists
    map:
      - _json.inventory.architecture: "NULL"

  - check:
      - _json.inventory.os_name: +ef_not_exists
    map:
      - _json.inventory.os_name: "NULL"

  - check:
      - _json.inventory.os_version: +ef_not_exists
    map:
      - _json.inventory.os_version: "NULL"

  - check:
      - _json.inventory.os_codename: +ef_not_exists
    map:
      - _json.inventory.os_codename: "NULL"

  - check:
      - _json.inventory.os_major: +ef_not_exists
    map:
      - _json.inventory.os_major: "NULL"

  - check:
      - _json.inventory.os_minor: +ef_not_exists
    map:
      - _json.inventory.os_minor: "NULL"

  - check:
      - _json.inventory.os_build: +ef_not_exists
    map:
      - _json.inventory.os_build: "NULL"

  - check:
      - _json.inventory.os_platform: +ef_not_exists
    map:
      - _json.inventory.os_platform: "NULL"

  - check:
      - _json.inventory.sysname: +ef_not_exists
    map:
      - _json.inventory.sysname: "NULL"

  - check:
      - _json.inventory.release: +ef_not_exists
    map:
      - _json.inventory.release: "NULL"

  - check:
      - _json.inventory.version: +ef_not_exists
    map:
      - _json.inventory.version: "NULL"

  - check:
      - _json.inventory.os_release: +ef_not_exists
    map:
      - _json.inventory.os_release: "NULL"

  - check:
      - _json.inventory.os_patch: +ef_not_exists
    map:
      - _json.inventory.os_patch: "NULL"

  - check:
      - _json.inventory.os_display_version: +ef_not_exists
    map:
      - _json.inventory.os_display_version: "NULL"

  - map:
      - _query: +s_concat/agent /$agent.id/ osinfo set /$_json.ID/|/$_json.timestamp/|/$_json.inventory.hostname/|/$_json.inventory.architecture/|/$_json.inventory.os_name/|/$_json.inventory.os_version/|/$_json.inventory.os_codename/|/$_json.inventory.os_major/|/$_json.inventory.os_minor/|/$_json.inventory.os_build/|/$_json.inventory.os_platform/|/$_json.inventory.sysname/|/$_json.inventory.release/|/$_json.inventory.version/|/$_json.inventory.os_release/|/$_json.inventory.os_patch/|/$_json.inventory.os_display_version
      - _hardware_save_result: +wdb_update/$_query
