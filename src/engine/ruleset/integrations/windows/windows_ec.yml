name: decoder/windows_event_channel/0

sources: 
  - decoder/queue-windowsevents/0

metadata:
  description: Parent decoder for Windows events  

check:
  - ~json.Event: +ef_exists

parse:
  logpar:
    - ~json.Event: <~event_channel/xml/windows>

normalize:
 - map:
   - event.code: $~event_channel.Event.System.EventID.#text
   - event.@timestamp: $~event_channel.Event.System.TimeCreated.@SystemTime
   - event.kind: event
   - event.provider: $~event_channel.Event.System.Provider.@Name
   - event.host.name: $~event_channel.Event.System.Computer.#text
   - event.level: +kvdb_get/win_log_level/$~event_channel.Event.System.Level.#text