name: decoder/windows_sysmon/0

sources: 
  - decoder/windows_event_channel/0

metadata:
  description: Decoder for Windows Sysmon events

check:
  - ~event_channel.Event.System.Provider.@Name: Microsoft-Windows-Sysmon


normalize:
 - map:
    - event.module: sysmon
    - event.kind: event
    
    
    # Add categorization fields
    - event:  +kvdb_get_merge/win_sysmon_categories/$event.code 

    - rule.name: $~event_channel.Event.event_data.RuleName
    - event.Hashes: $~event_channel.Event.event_data.Hash
    

 - check: event.code==255 
   map:
    - error.code: $event.code

 - check: event.code==25
  map:
    - event.message: $~event_channel.Event.event_data.Type