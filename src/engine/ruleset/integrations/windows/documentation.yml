title: Windows Security Integration
overview: This integration processes events from Windows Security channel, Powershell, Powershell/Operational and Sysmon
compatibility: All Windows versions
configuration: >
  To capture Powershell and Sysmon events, modify the `ossec.conf` file in a monitored agent as in the following block:
    ```xml
  <ossec_config>
      <localfile>
          <location>Microsoft-Windows-Sysmon/Operational</location>
          <log_format>eventchannel</log_format>
      </localfile>

      <localfile>
          <location>Microsoft-Windows-Powershell/Operational</location>
          <log_format>eventchannel</log_format>
      </localfile>

      <localfile>
          <location>Microsoft-Windows-Powershell</location>
          <log_format>eventchannel</log_format>
      </localfile>
  </ossec_config>
  ```
  To detect events with sysmon, the following command must be executed:
  ```
  Sysmon64.exe -i sysmon_config.xml
  ```
  This configuration file can be configured by following this documentation
  https://learn.microsoft.com/en-us/sysinternals/downloads/Sysmon

  The generated events can be found in the event viewer at this location: Microsoft-Windows-Sysmon/Operational

event:
  module: windows
  dataset: EventChannel

