name: syscollector_process_save

parent:
  - syscollector_process

check:
  - _syscollectorEventOriginal.process: +exists

normalize:
  - check:
      - _syscollectorEventOriginal.timestamp: +not_exists
    map:
      _syscollectorEventOriginal.timestamp: "NULL"

  - check:
      - _syscollectorEventOriginal.process.pid: +not_exists
    map:
      _syscollectorEventOriginal.process.pid: "NULL"

  - check:
      - _syscollectorEventOriginal.process.name: +not_exists
    map:
      _syscollectorEventOriginal.process.name: "NULL"

  - check:
    - _syscollectorEventOriginal.process.state: +not_exists
    map:
      _syscollectorEventOriginal.process.state: "NULL"

  - check:
      - _syscollectorEventOriginal.process.ppid: +not_exists
    map:
      _syscollectorEventOriginal.process.ppid: "NULL"

  - check:
      - _syscollectorEventOriginal.process.utime: +not_exists
    map:
      _syscollectorEventOriginal.process.utime: "NULL"

  - check:
      - _syscollectorEventOriginal.process.stime: +not_exists
    map:
      _syscollectorEventOriginal.process.stime: "NULL"

  - check:
      - _syscollectorEventOriginal.process.cmd: +not_exists
    map:
      _syscollectorEventOriginal.process.cmd: "NULL"

  - check:
      - _syscollectorEventOriginal.process.argvs: +exists
    map:
      _argvs_csv_str: +s_fromArray/,/$_syscollectorEventOriginal.process.argvs

  - check:
      - _syscollectorEventOriginal.process.argvs: +not_exists
    map:
      _argvs_csv_str: "NULL"

  - check:
      - _syscollectorEventOriginal.process.euser: +not_exists
    map:
      _syscollectorEventOriginal.process.euser: "NULL"

  - check:
      - _syscollectorEventOriginal.process.ruser: +not_exists
    map:
      _syscollectorEventOriginal.process.ruser: "NULL"

  - check:
      - _syscollectorEventOriginal.process.suser: +not_exists
    map:
      _syscollectorEventOriginal.process.suser: "NULL"

  - check:
      - _syscollectorEventOriginal.process.egroup: +not_exists
    map:
      _syscollectorEventOriginal.process.egroup: "NULL"

  - check:
      - _syscollectorEventOriginal.process.rgroup: +not_exists
    map:
      _syscollectorEventOriginal.process.rgroup: "NULL"

  - check:
      - _syscollectorEventOriginal.process.sgroup: +not_exists
    map:
      _syscollectorEventOriginal.process.sgroup: "NULL"

  - check:
      - _syscollectorEventOriginal.process.fgroup: +not_exists
    map:
      _syscollectorEventOriginal.process.fgroup: "NULL"

  - check:
      - _syscollectorEventOriginal.process.priority: +not_exists
    map:
      _syscollectorEventOriginal.process.priority: "NULL"

  - check:
      - _syscollectorEventOriginal.process.nice: +not_exists
    map:
      _syscollectorEventOriginal.process.nice: "NULL"

  - check:
      - _syscollectorEventOriginal.process.size: +not_exists
    map:
      _syscollectorEventOriginal.process.size: "NULL"

  - check:
      - _syscollectorEventOriginal.process.vm_size: +not_exists
    map:
      _syscollectorEventOriginal.process.vm_size: "NULL"

  - check:
      - _syscollectorEventOriginal.process.resident: +not_exists
    map:
      _syscollectorEventOriginal.process.resident: "NULL"

  - check:
      - _syscollectorEventOriginal.process.share: +not_exists
    map:
      _syscollectorEventOriginal.process.share: "NULL"

  - check:
      - _syscollectorEventOriginal.process.start_time: +not_exists
    map:
      _syscollectorEventOriginal.process.start_time: "NULL"

  - check:
      - _syscollectorEventOriginal.process.pgrp: +not_exists
    map:
      _syscollectorEventOriginal.process.pgrp: "NULL"

  - check:
      - _syscollectorEventOriginal.process.session: +not_exists
    map:
      _syscollectorEventOriginal.process.session: "NULL"

  - check:
      - _syscollectorEventOriginal.process.nlwp: +not_exists
    map:
      _syscollectorEventOriginal.process.nlwp: "NULL"

  - check:
      - _syscollectorEventOriginal.process.tgid: +not_exists
    map:
      _syscollectorEventOriginal.process.tgid: "NULL"

  - check:
      - _syscollectorEventOriginal.process.tty: +not_exists
    map:
      _syscollectorEventOriginal.process.tty: "NULL"

  - check:
      - _syscollectorEventOriginal.process.processor: +not_exists
    map:
      _syscollectorEventOriginal.process.processor: "NULL"

  - map:
      _query: +s_concat/agent /$_syscollectorEventOriginal.agent.id/ process save /$_syscollectorEventOriginal.ID /|/$_syscollectorEventOriginal.process.timestamp/|/$_syscollectorEventOriginal.process.pid/|/$_syscollectorEventOriginal.process.name/|/$_syscollectorEventOriginal.process.state/|/$_syscollectorEventOriginal.process.ppid/|/$_syscollectorEventOriginal.process.utime/|/$_syscollectorEventOriginal.process.stime/|/$_syscollectorEventOriginal.process.cmd/|/$_argvs_csv_str/|/$_syscollectorEventOriginal.process.euser/|/$_syscollectorEventOriginal.process.ruser/|/$_syscollectorEventOriginal.process.suser/|/$_syscollectorEventOriginal.process.egroup/|/$_syscollectorEventOriginal.process.rgroup/|/$_syscollectorEventOriginal.process.sgroup/|/$_syscollectorEventOriginal.process.fgroup/|/$_syscollectorEventOriginal.process.priority/|/$_syscollectorEventOriginal.process.nice/|/$_syscollectorEventOriginal.process.size/|/$_syscollectorEventOriginal.process.vm_size/|/$_syscollectorEventOriginal.process.resident/|/$_syscollectorEventOriginal.process.share/|/$_syscollectorEventOriginal.process.start_time/|/$_syscollectorEventOriginal.process.pgrp/|/$_syscollectorEventOriginal.process.session/|/$_syscollectorEventOriginal.process.nlwp/|/$_syscollectorEventOriginal.process.tgid/|/$_syscollectorEventOriginal.process.tty/|/$_syscollectorEventOriginal.process.processor
      _process_save_result: +wdb_update/$_query
