name: syscollector_port_save

parents:
  - syscollector_port

check:
  - _syscollectorEventOriginal.port: +exists

normalize:
  - check:
      - _syscollectorEventOriginal.timestamp: +not_exists
    map:
      _syscollectorEventOriginal.timestamp: "NULL"

  - check:
      - _syscollectorEventOriginal.port.protocol: +not_exists
    map:
      _syscollectorEventOriginal.port.protocol: "NULL"

  - check:
      - _syscollectorEventOriginal.port.local_ip: +not_exists
    map:
      _syscollectorEventOriginal.port.local_ip: "NULL"

  - check:
      - _syscollectorEventOriginal.port.local_port: +not_exists
    map:
      _syscollectorEventOriginal.port.local_port: "NULL"

  - check:
      - _syscollectorEventOriginal.port.remote_ip: +not_exists
    map:
      _syscollectorEventOriginal.port.remote_ip: "NULL"

  - check:
      - _syscollectorEventOriginal.port.remote_port: +not_exists
    map:
      _syscollectorEventOriginal.port.remote_port: "NULL"

  - check:
      - _syscollectorEventOriginal.port.tx_queue: +not_exists
    map:
      _syscollectorEventOriginal.port.tx_queue: "NULL"

  - check:
      - _syscollectorEventOriginal.port.rx_queue: +not_exists
    map:
      _syscollectorEventOriginal.port.rx_queue: "NULL"

  - check:
      - _syscollectorEventOriginal.port.inode: +not_exists
    map:
      _syscollectorEventOriginal.port.inode: "NULL"

  - check:
      - _syscollectorEventOriginal.port.state: +not_exists
    map:
      _syscollectorEventOriginal.port.state: "NULL"

  - check:
      - _syscollectorEventOriginal.port.PID: +not_exists
    map:
      _syscollectorEventOriginal.port.PID: "NULL"

  - check:
      - _syscollectorEventOriginal.port.process: +not_exists
    map:
      _syscollectorEventOriginal.port.process: "NULL"

  - map:
      _query: +s_concat/agent /$_syscollectorEventOriginal.agent.id/ port save /$_syscollectorEventOriginal.ID/|/$_syscollectorEventOriginal.timestamp/|/$_syscollectorEventOriginal.port.protocol/|/$_syscollectorEventOriginal.port.local_ip/|/$_syscollectorEventOriginal.port.local_port/|/$_syscollectorEventOriginal.port.remote_ip/|/$_syscollectorEventOriginal.port.remote_port/|/$_syscollectorEventOriginal.port.tx_queue/|/$_syscollectorEventOriginal.port.rx_queue/|/$_syscollectorEventOriginal.port.inode/|/$_syscollectorEventOriginal.port.state/|/$_syscollectorEventOriginal.port.PID/|/$_syscollectorEventOriginal.port.process
      _port_save_result: +wdb_update/$_query
