---
name: aws-s3-parse-region

metadata:
  description: Decoder for extracting the cloud regiond from Amazon S3
    server access logs
  references:
    - https://docs.aws.amazon.com/AmazonS3/latest/userguide/LogFormat.html
  product.name: Amazon S3 server access

parents:
  - aws-s3

check:
  - wazuh.modules.aws.source: +s_eq/s3_server_access

parse:
  logql:
    - _json.aws.host_header: <_>.<cloud.region>.<_>.<_>
