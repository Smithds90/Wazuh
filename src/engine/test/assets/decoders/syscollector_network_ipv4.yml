name: syscollector_network_ipv4

parents:
  - syscollector_network

check:
  - _iface_save_response: +is_true
  - _syscollectorEventOriginal.iface.IPv4: +exists

normalize:
  - check:
      - _syscollectorEventOriginal.iface.IPv4.gateway: +not_exists
    map:
      _syscollectorEventOriginal.iface.IPv4.gateway: "NULL"

  - check:
      - _syscollectorEventOriginal.iface.IPv4.dhcp: +not_exists
    map:
      _syscollectorEventOriginal.iface.IPv4.dhcp: "NULL"

  - check:
      - _syscollectorEventOriginal.iface.IPv4.metric: +not_exists
    map:
      _syscollectorEventOriginal.iface.IPv4.metric: "NULL"

  - map:
      _query: +s_concat/agent /$_syscollectorEventOriginal.agent.id/ netproto save /$_syscollectorEventOriginal.ID/|/$_syscollectorEventOriginal.iface.name/|0|/$_syscollectorEventOriginal.iface.IPv4.gateway/|/$_syscollectorEventOriginal.iface.IPv4.dhcp/|/$_syscollectorEventOriginal.iface.IPv4.metric
      _result_netproto_save: +wdb_update/$_query

  - check:
      - _syscollectorEventOriginal.iface.IPv4.address: +exists
    map:
      _result_saveNetInfoIPv4: +saveNetInfoIPv4/$_syscollectorEventOriginal.agent.id/$_syscollectorEventOriginal.ID/$_syscollectorEventOriginal.iface.name/$_syscollectorEventOriginal.iface.IPv4
