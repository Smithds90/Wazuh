name: decoder-test
check:
  - queue: +exists
  - location: +exists
  - message: +exists

parse:
  logql:
    # [Fri Jul 10 10:11:12 1992] {"test":"valuestr", "test2":"valuestr", "innerJson": {"intest":"val", "intest2":23}} host test_decoder_example[1234]: Test_example for acceptation test #17
    - message: "[<event.created/ANSIC>] <labels> <host> <log.origin.file.name>[<log.origin.file.line>]: <error.message>"

normalize:
  - map:
      decoded.queue: decoded_queue
      decoded.location: decoded_location
      decoded.message: decoded_message
      decoded.logline: $labels.innerJson.intest
      decoded.index: $labels.innerJson.intest2
