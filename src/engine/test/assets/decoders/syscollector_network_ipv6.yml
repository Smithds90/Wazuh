name: syscollector_network_ipv6

parents:
  - syscollector_network

check:
  - _iface_save_response: +is_true
  - _syscollectorEventOriginal.iface.IPv6: +exists

normalize:
  - check:
      - _syscollectorEventOriginal.iface.IPv6.gateway: +not_exists
    map:
      _syscollectorEventOriginal.iface.IPv6.gateway: "NULL"

  - check:
      - _syscollectorEventOriginal.iface.IPv6.dhcp: +not_exists
    map:
      _syscollectorEventOriginal.iface.IPv6.dhcp: "NULL"

  - check:
      - _syscollectorEventOriginal.iface.IPv6.metric: +not_exists
    map:
      _syscollectorEventOriginal.iface.IPv6.metric: "NULL"

  - map:
      _query: +s_concat/agent /$_syscollectorEventOriginal.agent.id/ netproto save /$_syscollectorEventOriginal.ID/|/$_syscollectorEventOriginal.iface.name/|1|/$_syscollectorEventOriginal.iface.IPv6.gateway/|/$_syscollectorEventOriginal.iface.IPv6.dhcp/|/$_syscollectorEventOriginal.iface.IPv6.metric
      _netproto_save_result: +wdb_update/$_query

  - check:
      - _syscollectorEventOriginal.iface.IPv6.address: +exists
    map:
      _result_saveNetInfoIPv6: +saveNetInfoIPv6/$_syscollectorEventOriginal.agent.id/$_syscollectorEventOriginal.ID/$_syscollectorEventOriginal.iface.name/$_syscollectorEventOriginal.iface.IPv6
