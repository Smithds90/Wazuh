name: syscollector_network_ipv6

parents:
  - syscollector_network

check:
  - _iface_save_response: +is_true
  - event.original.iface.IPv6: +exists

normalize:
  - check:
      - event.original.iface.IPv6.gateway: +not_exists
    map:
      event.original.iface.IPv6.gateway: "NULL"

  - check:
      - event.original.iface.IPv6.dhcp: +not_exists
    map:
      event.original.iface.IPv6.dhcp: "NULL"

  - check:
      - event.original.iface.IPv6.metric: +not_exists
    map:
      event.original.iface.IPv6.metric: "NULL"

  - map:
      _query: +s_concat/agent /$event.original.agent.id/ netproto save /$event.original.ID/|/$event.original.iface.name/|1|/$event.original.iface.IPv6.gateway/|/$event.original.iface.IPv6.dhcp/|/$event.original.iface.IPv6.metric
      _netproto_save_result: +wdb_update/$_query

  - check:
      - event.original.iface.IPv6.address: +exists
    map:
      _result_saveNetInfoIPv6: +saveNetInfoIPv6/$event.original.agent.id/$event.original.ID/$event.original.iface.name/$event.original.iface.IPv6
