---
name: cisco

parents:
  - default_syslog_queue

metadata:
  description: Generic Cisco Syslog decoder
  version:
    - Cisco IOS System, 15 SY
    - Cisco ASA version 9.10
  references:
    - https://www.cisco.com/c/en/us/td/docs/ios/15_0sy/system/messages/15sysmg.pdf
    - https://www.cisco.com/c/en/us/td/docs/routers/access/wireless/software/guide/SysMsgLogging.html
    - https://www.cisco.com/c/en/us/td/docs/ios/15_0sy/system/messages/15sysmg/sm15syovr.html

check:
  - event.original: +exists

parse:
  logql:
    # Parse header only (IOS and ASA)

    # "Feb 14 09:40:10.326: %LINEPROTO-5-UPDOWN: Line protocol on Interface GigabitEthernet0/1, changed state to up"
    - event.original: '<timestamp/SYSLOG>.<_/number>: %<cisco.ios.facility>-<event.severity>-<event.code>: <message>'

    # Mar  1 18:46:11: %SYS-5-CONFIG_I: Configured from console by vty2 (10.34.195.36)
    - event.original: '<timestamp/SYSLOG>: %<cisco.ios.facility>-<event.severity>-<event.code>: <message>'

    # "00:00:46: %LINK-3-UPDOWN: Interface Port-channel1, changed state to up"
    # "18:47:02: %SYS-5-CONFIG_I: Configured from console by vty2 (10.34.195.36)"
    - event.original: '<timestamp/24H_LOCALTIME>: %<cisco.ios.facility>-<event.severity>-<event.code>: <message>'

    # Mar  1 18:48:50.483 UTC: %SYS-5-CONFIG_I: Configured from console by vty2 (10.34.195.36)
    - event.original: '<timestamp/RFC3154_ID_TIMEZONE>: %<cisco.ios.facility>-<event.severity>-<event.code>: <message>'

normalize:
  - map:
      # host.os.platform: cisco-ios
      # host.os.type: cisco-ios
      # host.ip: wazuh.origin
      observer.vendor: Cisco
      service.type: "cisco"
      log.source.address: $wazuh.origin

  - check:
      - event.severity: 0
    map:
        log.level: "emergency"
  - check:
      - event.severity: 1
    map:
        log.level: "alert"
  - check:
      - event.severity: 2
    map:
        log.level: "critical"
  - check:
      - event.severity: 3
    map:
        log.level: "error"
  - check:
      - event.severity: 4
    map:
        log.level: "warning"
  - check:
      - event.severity: 5
    map:
        log.level: "notice"
  - check:
      - event.severity: 6
    map:
        log.level: "informational"
  - check:
      - event.severity: 7
    map:
        log.level: "debug"
