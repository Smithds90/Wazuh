---
name: cisco-ios-sec

parents:
  - cisco-ios

metadata:
  description: "Cisco IOS, Facility Code: SEC [IP security]"

  references:
    - "https://www.cisco.com/c/en/us/td/docs/ios/system/messages/guide/consol_smg/sm_cnovr.html"
    - "https://tools.cisco.com/security/center/resources/access_control_list_logging.html"

check:
  - log.syslog.facility.name: SEC

parse:
  logql:

    # %SEC-6-IPACCESSLOGP: list ACL-IPv4-E0/0-IN permitted tcp 192.168.1.3(1024) -> 192.168.2.1(22), 1 packet
    # %SEC-6-IPACCESSLOGP: list ACL-IPv4-E0/0-IN permitted tcp 192.168.1.3(1024) -> 192.168.2.1(22), 9 packets
    # TODO Should be: "list <_cisco.ACL.name> <_cisco.ACL.outcome> <network.transport> <source.ip>(<source.port>) -> <destination.ip>(<destination.port>), <source.packets> packet", but > is not supported
    - message: >-
        list <_cisco.ACL.name> <_cisco.ACL.outcome> <network.transport> <source.ip>(<source.port>) -<_dir/keyword> <destination.ip>(<destination.port>), <source.packets> packet

    # %SEC-6-IPACCESSLOGP: list ACL-IPv4-E0/0-IN permitted tcp 192.168.1.3(1025) (Ethernet0/0 000e.9b5a.9839) -> 192.168.2.1(22), 1 packet
    # %SEC-6-IPACCESSLOGP: list ACL-IPv4-E0/0-IN permitted tcp 192.168.1.3(1025) (Ethernet0/0 000e.9b5a.9839) -> 192.168.2.1(22), 9 packets
    # TODO Should be: "list <_cisco.ACL.name> <_cisco.ACL.outcome> <network.transport> <source.ip>(<source.port>) (<observer.ingress.interface.name> <_observer.ingress.interface.mac>) -> <destination.ip>(<destination.port>), <source.packets> packet"
    - message: >-
        list <_cisco.ACL.name> <_cisco.ACL.outcome> <network.transport> <source.ip>(<source.port>) (<observer.ingress.interface.name> <_observer.ingress.interface.mac>) -<_dir/keyword> <destination.ip>(<destination.port>), <source.packets> packet
