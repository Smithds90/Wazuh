name: syscollector_hotfix

parents:
  - syscollector_base

check:
  - _json.ID: +exists
  - _json.type: +s_starts/hotfix

normalize:
  - check:
      - _json.hotfix: +exists
    map:
      _query: +s_concat/agent /$agent.id/ hotfix save /$_json.ID/|/$_json.timestamp/|/$_json.hotfix
      _hotfix_save_response: +wdb_update/$_query

  - check:
      - _json.hotfix: +not_exists
      - _json.type: +s_eq/hotfix_end
    map:
      _query: +s_concat/agent /$agent.id/ hotfix del /$_json.ID
      _hotfix_del_response: +wdb_update/$_query
