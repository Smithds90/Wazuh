---
name: cisco-ios

parents:
  - default_syslog_queue

metadata:
  description: Cisco IOS System, 15 SY
  references:
    - https://www.cisco.com/c/en/us/td/docs/ios/15_0sy/system/messages/15sysmg.pdf
    - https://www.cisco.com/c/en/us/td/docs/routers/access/wireless/software/guide/SysMsgLogging.html
    - https://www.cisco.com/c/en/us/td/docs/ios/15_0sy/system/messages/15sysmg/sm15syovr.html


check:
  - event.original: +exists

parse:
  logql:
    # Parse header only

    # "Feb 14 09:40:10.326: %LINEPROTO-5-UPDOWN: Line protocol on Interface GigabitEthernet0/1, changed state to up"
    - event.original: '<timestamp/SYSLOG>.<_seqID/number>: %<log.syslog.facility.name>-<log.syslog.severity.code>-<log.syslog.severity.name>: <message/any>'

    # Mar  1 18:46:11: %SYS-5-CONFIG_I: Configured from console by vty2 (10.34.195.36)
    - event.original: '<timestamp/SYSLOG>: %<log.syslog.facility.name>-<log.syslog.severity.code>-<log.syslog.severity.name>: <message/any>'

    # "00:00:46: %LINK-3-UPDOWN: Interface Port-channel1, changed state to up"
    # "18:47:02: %SYS-5-CONFIG_I: Configured from console by vty2 (10.34.195.36)"
    - event.original: '<timestamp/24H_LOCALTIME>: %<log.syslog.facility.name>-<log.syslog.severity.code>-<log.syslog.severity.name>: <message/any>'

    # Mar  1 18:48:50.483 UTC: %SYS-5-CONFIG_I: Configured from console by vty2 (10.34.195.36)
    - event.original: '<timestamp/RC3154_W_ID_TIMEZONE>: %<log.syslog.facility.name>-<log.syslog.severity.code>-<log.syslog.severity.name>: <message/any>'

normalize:
  - map:
      # host.os.platform: cisco-ios
      host.os.type: cisco-ios
      host.ip: wazuh.origin
      observer.vendor: Cisco
      event.category: [ network ]
