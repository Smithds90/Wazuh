name: syscollector_osinfo

parents:
  - syscollector_base

check:
  - _syscollectorEventOriginal.inventory: +exists
  - _syscollectorEventOriginal.route: +s_eq/syscollector
  - _syscollectorEventOriginal.type: +s_eq/OS

normalize:
  - check:
      - _syscollectorEventOriginal.ID: +not_exists
    map:
      _syscollectorEventOriginal.ID: "NULL"

  - check:
      - _syscollectorEventOriginal.timestamp: +not_exists
    map:
      _syscollectorEventOriginal.timestamp: "NULL"

  - check:
      - _syscollectorEventOriginal.inventory.hostname: +not_exists
    map:
      _syscollectorEventOriginal.inventory.hostname: "NULL"

  - check:
      - _syscollectorEventOriginal.inventory.architecture: +not_exists
    map:
      _syscollectorEventOriginal.inventory.architecture: "NULL"

  - check:
      - _syscollectorEventOriginal.inventory.cpu_cores: +not_exists
    map:
      _syscollectorEventOriginal.inventory.cpu_cores: "NULL"

  - check:
      - _syscollectorEventOriginal.inventory.os_name: +not_exists
    map:
      _syscollectorEventOriginal.inventory.os_name: "NULL"

  - check:
      - _syscollectorEventOriginal.inventory.os_version: +not_exists
    map:
      _syscollectorEventOriginal.inventory.os_version: "NULL"

  - check:
      - _syscollectorEventOriginal.inventory.os_codename: +not_exists
    map:
      _syscollectorEventOriginal.inventory.os_codename: "NULL"

  - check:
      - _syscollectorEventOriginal.inventory.os_major: +not_exists
    map:
      _syscollectorEventOriginal.inventory.os_major: "NULL"

  - check:
      - _syscollectorEventOriginal.inventory.os_minor: +not_exists
    map:
      _syscollectorEventOriginal.inventory.os_minor: "NULL"

  - check:
      - _syscollectorEventOriginal.inventory.os_build: +not_exists
    map:
      _syscollectorEventOriginal.inventory.os_build: "NULL"

  - check:
      - _syscollectorEventOriginal.inventory.os_platform: +not_exists
    map:
      _syscollectorEventOriginal.inventory.os_platform: "NULL"

  - check:
      - _syscollectorEventOriginal.inventory.sysname: +not_exists
    map:
      _syscollectorEventOriginal.inventory.sysname: "NULL"

  - check:
      - _syscollectorEventOriginal.inventory.release: +not_exists
    map:
      _syscollectorEventOriginal.inventory.release: "NULL"

  - check:
      - _syscollectorEventOriginal.inventory.version: +not_exists
    map:
      _syscollectorEventOriginal.inventory.version: "NULL"

  - check:
      - _syscollectorEventOriginal.inventory.os_release: +not_exists
    map:
      _syscollectorEventOriginal.inventory.os_release: "NULL"

  - check:
      - _syscollectorEventOriginal.inventory.os_patch: +not_exists
    map:
      _syscollectorEventOriginal.inventory.os_patch: "NULL"

  - check:
      - _syscollectorEventOriginal.inventory.os_display_version: +not_exists
    map:
      _syscollectorEventOriginal.inventory.os_display_version: "NULL"

  - check:
      _decode_osinfo_sectionon: +i_eq/1
    map:
      _query: +s_concat/agent /$_syscollectorEventOriginal.agent.id/ osinfo set /$_syscollectorEventOriginal.ID/|/$_syscollectorEventOriginal.timestamp/|/$_syscollectorEventOriginal.inventory.hostname/|/$_syscollectorEventOriginal.inventory.architecture/|/$_syscollectorEventOriginal.inventory.os_name/|/$_syscollectorEventOriginal.inventory.os_version/|/$_syscollectorEventOriginal.inventory.os_codename/|/$_syscollectorEventOriginal.inventory.os_major/|/$_syscollectorEventOriginal.inventory.os_minor/|/$_syscollectorEventOriginal.inventory.os_build/|/$_syscollectorEventOriginal.inventory.os_platform/|/$_syscollectorEventOriginal.inventory.sysname/|/$_syscollectorEventOriginal.inventory.release/|/$_syscollectorEventOriginal.inventory.version/|/$_syscollectorEventOriginal.inventory.os_release/|/$_syscollectorEventOriginal.inventory.os_patch/|/$_syscollectorEventOriginal.inventory.os_display_version
      _hardware_save_result: +wdb_update/$_query
