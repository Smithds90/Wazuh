# wazuh-bolt-on

Addons to allow output of user definable alerts to an sqlite database, and check that database for unclassified alerts using nagios or whatever your preferred montoring system is.  There is also a text based (only, for now) user menu to allow operators to acknowledge and classify alerts, to remove the nagios alert.

Its intended use is to generate close to real time alerts for the highest severity alert (known attack) and have this appear on a monitoring system, but the level is user configurable.  Written off the back of the below issue/question:

https://github.com/wazuh/wazuh/issues/3337


As an attempt to keep the directory structure the same and allow for a drop into an existing wazuh installation, it contains

- integrations

For integration plugins, this currently only has a sqlite plugin

- tools

Directory that has a nagios plugin and a plugin for operators to review alerts generated by the integrations plugin.

## custom-sqlite

Plugin is configured in ossec.conf like so:
```
  <integration>
    <name>custom-sqlite</name>
    <alert_format>json</alert_format>
    <level>15</level>
  </integration>
```
This will output some of the alert fields to a alerts.db file in the ossec directory.

## check_wazuh_uc.py

Check the database for unclassified alerts (checking user should be in the ossec group):
```
./wazuh-bolt-on/tools/nagios/check_wazuh_uc.py 
CRITICAL - There are 1 unclassified alerts
```
## review_wazuh_uc.py

Allow the operator (must be in the ossec group) to review and classify the alert
```
 ./wazuh-bolt-on/tools/soc/review_wazuh_uc.py   
                                                           
-------------------- SIEM SOC OPS MENU --------------------
1. Display all unclassified alerts 
2. Display all alerts, ever 
3. Classify a single alert 
4. Classify a range of alerts 
5. Classify ALL unclassified alerts (careful now) 
6. Quit 
-----------------------------------------------------------
                                                           
Enter your choice [1-6]: 
```

## Software and libraries used

- [Python](https://www.python.org/) 3.5+
